<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>Zenroom LUA</title>
    <link rel="stylesheet" href="" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>Zenroom</h1>


<ul>
  <li><a href="../index.html">Index</a></li>
</ul>

<h2>Contents</h2>
<ul>
<li><a href="#Class_keyring">Class keyring </a></li>
</ul>


<h2>Modules</h2>
<ul class="nowrap">
  <li><a href="../modules/OCTET.html">OCTET</a></li>
  <li><a href="../modules/HASH.html">HASH</a></li>
  <li><a href="../modules/ECP.html">ECP</a></li>
  <li><a href="../modules/BIG.html">BIG</a></li>
  <li><a href="../modules/FLOAT.html">FLOAT</a></li>
  <li><a href="../modules/TIME.html">TIME</a></li>
  <li><a href="../modules/AES.html">AES</a></li>
  <li><strong>ECDH</strong></li>
  <li><a href="../modules/ED.html">ED</a></li>
  <li><a href="../modules/P256.html">P256</a></li>
  <li><a href="../modules/QP.html">QP</a></li>
  <li><a href="../modules/String.html">String</a></li>
  <li><a href="../modules/Table.html">Table</a></li>
  <li><a href="../modules/INSPECT.html">INSPECT</a></li>
  <li><a href="../modules/lua.zencode.html">lua.zencode</a></li>
  <li><a href="../modules/BBS.html">BBS</a></li>
</ul>

</div>

<div id="content">

<h1>Module <code>ECDH</code></h1>
<p>

<h1>Elliptic Curve Diffie-Hellman encryption (ECDH)</h1>


<p>  Asymmetric public/private key encryption technologies.</p>
</p>
<p>  ECDH encryption and ECDSA signing functionalities are provided by
  this module. New keyring instances are instantiated by calling the
  new() method, keys can be imported using the</p>

<p>  <code>
  Alice = ECDH.new()
  Bob = ECDH.new()
  </code></p>

<p>  One can create more keyrings in the same script and call them with
  meaningful variable names to help making code more
  understandable. Each keyring instance offers methods prefixed with
  a double-colon that operate on arguments as well keys contained by
  the keyring: this way scripting can focus on the identities
  represented by each keyring, giving them names as 'Alice' or
  'Bob'.</p>
    <h3>Info:</h3>
    <ul>
        <li><strong>Copyright</strong>: Dyne.org foundation 2017-2020</li>
        <li><strong>License</strong>: AGPLv3</li>
        <li><strong>Author</strong>: Denis "Jaromil" Roio</li>
    </ul>


<h2><a href="#Class_keyring">Class keyring </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#keyring:keygen">keyring:keygen ()</a></td>
	<td class="summary">Generate an ECDH public/private key pair for a keyring</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#keyring:pubgen">keyring:pubgen ()</a></td>
	<td class="summary">Generate an ECDH public key from a secret key</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#keyring:xy">keyring:xy ()</a></td>
	<td class="summary">Returns X and Y coordinates of a public key</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#keyring:sign">keyring:sign (message)</a></td>
	<td class="summary">Elliptic Curve Digital Signature Algorithm (ECDSA) signing
   function.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#keyring:sign_deterministic">keyring:sign_deterministic (message, sha)</a></td>
	<td class="summary">Elliptic Curve Digital Signature Algorithm (ECDSA) signing
   function with deterministic generation of k (see RFC6979 https://www.rfc-editor.org/rfc/rfc6979).</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#keyring.sk">keyring.sk</a></td>
	<td class="summary">Sign a message directly, without taking the hash (the input in an hashed message
 that is it is already hashed)</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#keyring:verify">keyring:verify (message, signature)</a></td>
	<td class="summary">Elliptic Curve Digital Signature Algorithm (ECDSA) verification
   function.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#keyring:verify_deterministic">keyring:verify_deterministic (message, signature, sha)</a></td>
	<td class="summary">Elliptic Curve Digital Signature Algorithm (ECDSA) verification
   function.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#keyring:order">keyring:order ()</a></td>
	<td class="summary">Order of the curve underlying the ECDH implementation</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#keyring:prime">keyring:prime ()</a></td>
	<td class="summary">Modulus of the curve underlying the ECDH implementation</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#keyring:cofactor">keyring:cofactor ()</a></td>
	<td class="summary">Cofactor of the curve underlying the ECDH implementation</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#keyring.x">keyring.x</a></td>
	<td class="summary">Elliptic Curve Digital Signature Algorithm (ECDSA) recovery function.</td>
	</tr>
</table>

<br/>
<br/>


    <h2 class="section-header has-description"><a name="Class_keyring"></a>Class keyring </h2>

          <div class="section-description">
          Instance Methods
          </div>
    <dl class="function">
    <dt>
    <a name = "keyring:keygen"></a>
    <strong>keyring:keygen ()</strong>
    </dt>
    <dd>
    Generate an ECDH public/private key pair for a keyring    Keys generated are both returned and stored inside the keyring
   table as public and private properties.
()



    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">OCTET</span></span>
        public key</li>
        <li>
           <span class="types"><span class="type">OCTET</span></span>
        private key</li>
    </ol>




</dd>
    <dt>
    <a name = "keyring:pubgen"></a>
    <strong>keyring:pubgen ()</strong>
    </dt>
    <dd>
    Generate an ECDH public key from a secret key    Public key is returned.
()



    <h3>Returns:</h3>
    <ol>

        OCTET public key
    </ol>




</dd>
    <dt>
    <a name = "keyring:xy"></a>
    <strong>keyring:xy ()</strong>
    </dt>
    <dd>
    Returns X and Y coordinates of a public key (public_key)



    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">OCTET</span></span>
        coordinate X of public key</li>
        <li>
           <span class="types"><span class="type">OCTET</span></span>
        coordinate Y of public key</li>
    </ol>




</dd>
    <dt>
    <a name = "keyring:sign"></a>
    <strong>keyring:sign (message)</strong>
    </dt>
    <dd>
    Elliptic Curve Digital Signature Algorithm (ECDSA) signing
   function.  This method uses the private key inside a keyring to sign
   a message, returning a signature to be used in <a href="../modules/ECDH.html#keyring:verify">keyring:verify</a>.
(kp.private, message)


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">message</span>
         string or <a href="../modules/OCTET.html#">OCTET</a> message to sign
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        table containing signature parameters octets (r,s)
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example">kp = ECDH.<span class="function-name">keygen</span>() <span class="comment">-- generate keys or import them
</span>m = <span class="string">"Message to be signed"</span>
signature = ECDH.<span class="function-name">sign</span>(kp.private, m)
<span class="global">assert</span>( ECDH.<span class="function-name">verify</span>(kp.public, m, signature) )</pre>
    </ul>

</dd>
    <dt>
    <a name = "keyring:sign_deterministic"></a>
    <strong>keyring:sign_deterministic (message, sha)</strong>
    </dt>
    <dd>
    Elliptic Curve Digital Signature Algorithm (ECDSA) signing
   function with deterministic generation of k (see RFC6979 https://www.rfc-editor.org/rfc/rfc6979).
   This method uses the private key inside a keyring to sign
   a message, returning a signature to be used in <a href="../modules/ECDH.html#keyring:verify_deterministic">keyring:verify_deterministic</a>.
(kp.private, message, sha)


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">message</span>
         string or <a href="../modules/OCTET.html#">OCTET</a> message to sign
        </li>
        <li><span class="parameter">sha</span>
         int length in bytes of the digest of the SHA function
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        table containing signature parameters octets and k (r,s,k)
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example">kp = ECDH.<span class="function-name">keygen</span>() <span class="comment">-- generate keys or import them
</span>m = <span class="string">"Message to be signed"</span>
sha = <span class="number">32</span> <span class="comment">-- This is SHA256. Also 48 = SHA384 or 64 = SHA512 may be used.
</span>signature = ECDH.<span class="function-name">sign_deterministic</span>(kp.private, m, sha)
<span class="global">assert</span>( ECDH.<span class="function-name">verify_determinitsic</span>(kp.public, m, signature, sha) )</pre>
    </ul>

</dd>
    <dt>
    <a name = "keyring.sk"></a>
    <strong>keyring.sk</strong>
    </dt>
    <dd>
    Sign a message directly, without taking the hash (the input in an hashed message
 that is it is already hashed)


    <ul>
        <li><span class="parameter">sk</span>
         private key
        </li>
        <li><span class="parameter">m</span>
         hashed message
        </li>
        <li><span class="parameter">n</span>
         size of the message
        </li>
        <li><span class="parameter">k</span>
         ephemeral private key (not mandatory)
        </li>
    </ul>





</dd>
    <dt>
    <a name = "keyring:verify"></a>
    <strong>keyring:verify (message, signature)</strong>
    </dt>
    <dd>
    Elliptic Curve Digital Signature Algorithm (ECDSA) verification
   function.  This method uses the public key inside a keyring to verify
   a message, returning true or false. The signature parameters are
   returned as 'r' and 's' in this same order by <a href="../modules/ECDH.html#keyring:sign">keyring:sign</a>.
(kp.public, message,signature)


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">message</span>
         the message whose signature has to be verified
        </li>
        <li><span class="parameter">signature</span>
         the signature table returned by <a href="../modules/ECDH.html#keyring:sign">keyring:sign</a>
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        true if the signature is OK, or false if not.
    </ol>


    <h3>See also:</h3>
    <ul>
         <a href="../modules/ECDH.html#keyring:sign">ECDH.sign</a>
    </ul>


</dd>
    <dt>
    <a name = "keyring:verify_deterministic"></a>
    <strong>keyring:verify_deterministic (message, signature, sha)</strong>
    </dt>
    <dd>
    Elliptic Curve Digital Signature Algorithm (ECDSA) verification
   function.  The main difference between ecdh<em>dsa</em>verify and this function
   is that here we also consider the input parameter sha int.
   This method uses the public key inside a keyring to verify
   a message, returning true or false. The signature parameters are
   returned as 'r' and 's' in this same order by <a href="../modules/ECDH.html#keyring:sign_deterministic">keyring:sign_deterministic</a>.
(kp.public, message, signature, sha)


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">message</span>
         the message whose signature has to be verified
        </li>
        <li><span class="parameter">signature</span>
         the signature table returned by <a href="../modules/ECDH.html#keyring:sign_deterministic">keyring:sign_deterministic</a>
        </li>
        <li><span class="parameter">sha</span>
         int length in bytes of the digest of the SHA function
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        true if the signature is OK, or false if not.
    </ol>


    <h3>See also:</h3>
    <ul>
         <a href="../modules/ECDH.html#keyring:sign_deterministic">ECDH.sign_deterministic</a>
    </ul>


</dd>
    <dt>
    <a name = "keyring:order"></a>
    <strong>keyring:order ()</strong>
    </dt>
    <dd>
    Order of the curve underlying the ECDH implementation ()



    <h3>Returns:</h3>
    <ol>

        BIG with the order
    </ol>




</dd>
    <dt>
    <a name = "keyring:prime"></a>
    <strong>keyring:prime ()</strong>
    </dt>
    <dd>
    Modulus of the curve underlying the ECDH implementation ()



    <h3>Returns:</h3>
    <ol>

        BIG with the modulus
    </ol>




</dd>
    <dt>
    <a name = "keyring:cofactor"></a>
    <strong>keyring:cofactor ()</strong>
    </dt>
    <dd>
    Cofactor of the curve underlying the ECDH implementation ()



    <h3>Returns:</h3>
    <ol>

        int with the cofactor
    </ol>




</dd>
    <dt>
    <a name = "keyring.x"></a>
    <strong>keyring.x</strong>
    </dt>
    <dd>
    Elliptic Curve Digital Signature Algorithm (ECDSA) recovery function.
   This method is intended to be used over all the possible point (x,y)
   that create the ephemeral public key of the signature, i.e.
   x can be equal to r+j*n where j is in [0,..,h] (h cofactor of the curve),
   n is the order of the curve and r is the first component of the signature.
   While y is uniquely identified by its parity.
   This method, if it exists, will output a public key Q for which (r, s)
   is a valid signature on the hashed message m.


    <ul>
        <li><span class="parameter">x</span>
         the x coordinate of the ephemeral public key
        </li>
        <li><span class="parameter">y_parity</span>
         parity of y coordinate of the ephemeral public key
        </li>
        <li><span class="parameter">m</span>
         hashed message
        </li>
        <li><span class="parameter">sig</span>
         the signature (r,s)
        </li>
    </ul>





</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/lunarmodules/LDoc">LDoc 1.5.0</a></i>
<i style="float:right;">Last updated 2025-03-25 10:43:18 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
